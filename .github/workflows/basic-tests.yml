name: basic tests

on: [push, pull_request]

jobs:
    build:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3
            - name: Check if collection version correctly matches install_info
              run: |
                galaxy_collection_version=$(cat galaxy.yml | grep "version:" | awk -F: '{print $2}' | xargs)
                install_info_collection_version=$(cat roles/agent/templates/install_info.j2| grep -o "datadog_collection_.*_agent_role" | awk -F_ '{ print $3 }')
                test "$galaxy_collection_version" = "$install_info_collection_version"               
